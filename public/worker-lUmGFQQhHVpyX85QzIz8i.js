self.addEventListener("push",n=>{if(n.data)try{const i=n.data.json(),o=i.title||"通知",t={body:i.body,icon:i.icon||"/icon-192x192.png",badge:i.badge||"/icon-96x96.png",data:i.data};n.waitUntil(self.registration.showNotification(o,t))}catch(n){console.error("Error handling push event:",n)}}),self.addEventListener("notificationclick",n=>{var i;n.notification.close();const o=new URL((null===(i=n.notification.data)||void 0===i?void 0:i.url)||"/",self.location.origin).href;n.waitUntil(self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(n=>{for(const i of n)if(i.url===o&&"focus"in i)return i.focus();if(self.clients.openWindow)return self.clients.openWindow(o)}))});